view-log.php
<?php
$file = __DIR__ . '/logs/events.csv';
if (!file_exists($file)) {
  die('<h2 style="font-family:Arial;">No log file found.</h2>');
}

$rows   = array_reverse(array_map('str_getcsv', file($file)));
$total  = count($rows);
$visits = count(array_filter($rows, fn($r)=>$r[2]==='visit'));
$clicks = count(array_filter($rows, fn($r)=>$r[2]==='click'));
?>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Event Log</title>

<!-- ‚ë† Ëá™Âä® 5s Âà∑Êñ∞ -->
<meta http-equiv="refresh" content="5">

<style>
body{font-family:Arial, sans-serif;background:#f8f9fa;margin:0;padding:20px;}
h1{margin:0 0 10px;font-size:22px;}
.stats{color:#555;margin-bottom:12px;}
table{width:100%;border-collapse:collapse;font-size:14px;}
th,td{border:1px solid #ddd;padding:8px;text-align:left;}
th{background:#343a40;color:#fff;font-weight:600;}
tr:nth-child(even){background:#fafafa;}
tr:hover{background:#ffeeba;}
small{color:#888}
.btn{display:inline-block;margin:10px 6px 0 0;padding:6px 14px;background:#007bff;color:#fff;
     text-decoration:none;border-radius:4px;font-size:13px;}
.btn:hover{background:#0069d9;}
</style>
</head>

<body>
<h1>üìä AI-Stock Landing ‚Äì Event Log</h1>
<p class="stats">
  Total <strong><?= $total ?></strong> events&nbsp;|&nbsp;
  Visits <strong><?= $visits ?></strong>&nbsp;|&nbsp;
  Clicks <strong><?= $clicks ?></strong>
</p>

<!-- ‚ë° ÊâãÂä®Âà∑Êñ∞ÊåâÈíÆ -->
<a href="#" class="btn" onclick="location.reload(); return false;">üîÑ Refresh now</a>
<a href="logs/events.csv" class="btn" download>‚¨áÔ∏è Download CSV</a>

<table>
  <thead>
    <tr>
      <th>Timestamp</th><th>IP</th><th>Event</th><th>Page</th><th>User-Agent</th>
    </tr>
  </thead>
  <tbody>
  <?php foreach($rows as $r): ?>
    <tr>
      <td><?= htmlspecialchars($r[0]??'') ?></td>
      <td><?= htmlspecialchars($r[1]??'') ?></td>
      <td><?= htmlspecialchars($r[2]??'') ?></td>
      <td><?= htmlspecialchars($r[3]??'') ?></td>
      <td><small><?= htmlspecialchars($r[4]??'') ?></small></td>
    </tr>
  <?php endforeach; ?>
  </tbody>
</table>
</body>
</html>





log.php
<?php
// ===== Âü∫Êú¨ÂÆâÂÖ®ÔºöÂè™ÂÖÅËÆ∏ POST =====
if ($_SERVER['REQUEST_METHOD'] !== 'POST') { http_response_code(405); exit; }

$event = $_POST['event'] ?? 'unknown';
$page  = $_POST['page']  ?? 'unknown';
$time  = date('Y-m-d H:i:s');
$ip    = $_SERVER['REMOTE_ADDR'] ?? '';
$ua    = $_SERVER['HTTP_USER_AGENT'] ?? '';

// ===== ‰øùÂ≠òÂà∞ logs/events.csv =====
$dir = __DIR__ . '/logs';
if (!is_dir($dir)) mkdir($dir, 0755, true);
$file = $dir . '/events.csv';

$fh = fopen($file, 'a');
fputcsv($fh, [$time, $ip, $event, $page, $ua]);
fclose($fh);

// ===== ËøîÂõû 204 Êó†ÂÜÖÂÆπ =====
http_response_code(204);
